<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://eu.i.posthog.com https://cdn.jsdelivr.net https://eu-assets.i.posthog.com; img-src 'self' https://media.githubusercontent.com data: blob:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net;">
    <title>Adoption Generator</title>
    <link rel="icon" type="image/png" href="../assets/images/beasty-favicon-rounded.png">
    <link rel="stylesheet" href="../assets/styles/pages/single-cat.css">
    <link rel="stylesheet" href="../assets/styles/pages/adoption-generator.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.11.2/cdn/shoelace.js"></script>
</head>
<body class="sl-theme-dark adoption-generator">
    <a class="back-btn" href="../index.html">← Back</a>

    <div class="bg"></div>
    <div class="blob blob-a"></div>
    <div class="blob blob-b"></div>
    <div class="blob blob-c"></div>

    <main class="page-wrapper">
        <header class="page-header">
            <h1>Adoption Generator</h1>
            <p class="page-subtitle">Roll a full litter at once, prune after every reveal, and finish with ten finalists.</p>
            <div class="stage-info">
                <span id="stageStatus" class="stage-status">Select your options and generate to begin.</span>
                <span class="stage-count">Cats Remaining: <strong id="catCountDisplay">—</strong></span>
            </div>
        </header>

        <section class="controls-panel">
            <div class="controls-left">
                <button id="generateButton" class="generate-button">Generate Adoption</button>
                <div class="sl-toggle-group">
                    <span class="setting-label">Speed:</span>
                    <sl-radio-group id="speedGroup" class="sl-segment" value="normal">
                        <sl-radio-button value="fast">Fast</sl-radio-button>
                        <sl-radio-button value="normal">Normal</sl-radio-button>
                        <sl-radio-button value="slow">Chill</sl-radio-button>
                    </sl-radio-group>
                </div>
            </div>
            <div class="controls-right">
                <div class="control-row">
                    <span class="toggle-label">Layer Counts:</span>
                    <label class="select-label" for="accCount">
                        Accessories
                        <div class="select-wrap">
                            <div class="select-inner">
                                <select id="accCount">
                                    <option value="1">1</option>
                                    <option value="2" selected>2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                                <span class="select-caret">▾</span>
                            </div>
                        </div>
                    </label>
                    <label class="select-label" for="scarCount">
                        Scars
                        <div class="select-wrap">
                            <div class="select-inner">
                                <select id="scarCount">
                                    <option value="1">1</option>
                                    <option value="2" selected>2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                                <span class="select-caret">▾</span>
                            </div>
                        </div>
                    </label>
                    <label class="select-label" for="tortieCount">
                        Tortie Layers
                        <div class="select-wrap">
                            <div class="select-inner">
                                <select id="tortieCount">
                                    <option value="1">1</option>
                                    <option value="2" selected>2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                </select>
                                <span class="select-caret">▾</span>
                            </div>
                        </div>
                    </label>
                </div>
                <div class="control-row">
                    <span class="toggle-label">Alignment:</span>
                    <label class="select-label" for="darkForestMode">
                        Dark Forest
                        <div class="select-wrap">
                            <div class="select-inner">
                                <select id="darkForestMode">
                                    <option value="off">Off</option>
                                    <option value="random10" selected>Random (10%)</option>
                                    <option value="on">On</option>
                                </select>
                                <span class="select-caret">▾</span>
                            </div>
                        </div>
                    </label>
                    <label class="select-label" for="deadMode">
                        Star Clan
                        <div class="select-wrap">
                            <div class="select-inner">
                                <select id="deadMode">
                                    <option value="off">Off</option>
                                    <option value="random10" selected>Random (10%)</option>
                                    <option value="on">On</option>
                                </select>
                                <span class="select-caret">▾</span>
                            </div>
                        </div>
                    </label>
                </div>
                <div class="control-row palette-toggle-row" id="extendedPaletteControls">
                    <span class="setting-label">Additional Colors:</span>
                    <div class="palette-toggle-buttons">
                        <button type="button" class="palette-toggle active" data-extended-mode="base" aria-pressed="true">Base</button>
                        <button type="button" class="palette-toggle" data-extended-mode="mood" aria-pressed="false">Mood</button>
                        <button type="button" class="palette-toggle" data-extended-mode="bold" aria-pressed="false">Bold</button>
                        <button type="button" class="palette-toggle" data-extended-mode="darker" aria-pressed="false">Darker</button>
                        <button type="button" class="palette-toggle" data-extended-mode="blackout" aria-pressed="false">Blackout</button>
                        <button type="button" class="palette-reset" data-extended-reset>Clear</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="grid-panel">
            <div id="catGrid" class="cat-grid" aria-live="polite"></div>
            <p class="removal-tip" id="removalTip">Hover a cat to cull it when prompted.</p>
        </section>
    </main>

    <template id="catCardTemplate">
        <article class="cat-card">
            <div class="cat-canvas-wrapper">
                <canvas class="cat-canvas" width="220" height="220"></canvas>
                <div class="cat-overlay">
                    <button class="cat-remove" type="button" title="Remove this cat">✕</button>
                </div>
            </div>
            <div class="cat-meta">
                <span class="cat-label"></span>
                <span class="cat-stage-value"></span>
            </div>
        </article>
    </template>

    <div id="catDetailOverlay" class="cat-detail-overlay" aria-hidden="true">
        <div class="overlay-backdrop" data-overlay-close></div>
        <div class="overlay-content" role="dialog" aria-modal="true" aria-labelledby="detailTitle">
            <button class="overlay-close" type="button" data-overlay-close title="Close">✕</button>
            <div class="overlay-body">
                <div class="overlay-canvas-wrap">
                    <canvas id="detailCanvas" width="700" height="700"></canvas>
                </div>
                <div class="overlay-info">
                    <h2 id="detailTitle">Cat Details</h2>
                    <div id="detailTable" class="parameter-table overlay-parameter-table"></div>
                    <div class="overlay-sprites">
                        <h3>Sprite Variations</h3>
                        <p class="overlay-sprites-sub">Click any option to copy the sprite.</p>
                        <div id="detailSpritesGrid" class="overlay-sprites-grid"></div>
                    </div>
                    <div class="overlay-actions">
                        <button id="detailCopyBig" class="overlay-btn">Copy Cat (700×700)</button>
                        <button id="detailCopyShare" class="overlay-btn">Copy Share URL</button>
                        <button id="detailOpenViewer" class="overlay-btn">Open Viewer</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="../js/posthog-init.js"></script>
    <script>
        window.adoptionConfig = {
            accessories: { min: 1, max: 4 },
            tortie: { min: 1, max: 4 }
        };
    </script>
    <script type="module" src="../js/pages/adoption-generator.js"></script>
</body>
</html>
